# CarlaRL Policy Model Card
# Version: v0.1.0

# Basic Information
model_name: "carla-ppo"
version: "v0.1.0"
model_type: "pytorch"
description: "CarlaRL PPO policy trained for autonomous driving in CARLA simulator"
created_date: "2025-09-27"
framework_version: "2.1.0"

# Model Architecture
input_shape: [5]  # [speed, steering, sensor1, sensor2, sensor3]
output_shape: [3]  # [throttle, brake, steer]
model_filename: "model.pt"
preprocessor_filename: "preprocessor.pkl"

# Training Information
training:
  algorithm: "PPO"
  episodes: 1000
  total_timesteps: 1000000
  environment: "CARLA-v0"
  observation_space:
    speed:
      type: "continuous"
      range: [0.0, 200.0]
      unit: "km/h"
    steering:
      type: "continuous"
      range: [-1.0, 1.0]
      unit: "normalized"
    sensors:
      type: "continuous_array"
      length: 3
      range: [-10.0, 10.0]
      description: "Normalized sensor readings"
  action_space:
    throttle:
      type: "continuous"
      range: [0.0, 1.0]
      description: "Throttle intensity"
    brake:
      type: "continuous"
      range: [0.0, 1.0]
      description: "Brake intensity"
    steer:
      type: "continuous"
      range: [-1.0, 1.0]
      description: "Steering angle"

# Performance Metrics
performance_metrics:
  training:
    final_reward: 850.5
    success_rate: 0.95
    episodes_to_convergence: 800
    training_time_hours: 12.5
  evaluation:
    average_reward: 820.3
    success_rate: 0.92
    completion_rate: 0.89
    collision_rate: 0.08
  inference:
    latency_p50_ms: 8.2
    latency_p95_ms: 15.1
    latency_p99_ms: 28.4
    throughput_obs_per_sec: 1250

# Model Behavior
behavior:
  driving_style: "conservative"
  preferred_speed_kmh: 45
  lane_keeping_accuracy: 0.94
  obstacle_avoidance: "excellent"
  traffic_light_compliance: 0.96

# Preprocessing Configuration
preprocessing:
  type: "StandardFeaturePreprocessor"
  normalization:
    speed:
      enabled: true
      method: "z_score"
      mean: 35.2
      std: 18.7
    steering:
      enabled: true
      method: "z_score"
      mean: 0.02
      std: 0.31
    sensors:
      enabled: true
      method: "z_score"
      clipping_range: [-10.0, 10.0]
      mean: 2.1
      std: 3.8

# Deployment Configuration
deployment:
  recommended_hardware:
    cpu: "4+ cores"
    memory: "8GB+"
    gpu: "optional"
  performance_targets:
    latency_p50_ms: 10.0
    throughput_min_obs_per_sec: 1000
  batch_sizes:
    optimal: 10
    maximum: 1000
  caching:
    enabled: true
    size: 1000

# Quality Assurance
quality_assurance:
  testing:
    unit_tests_passed: true
    integration_tests_passed: true
    performance_tests_passed: true
    safety_tests_passed: true
  validation:
    train_serve_parity: true
    deterministic_inference: true
    numerical_stability: true
  monitoring:
    drift_detection: "enabled"
    performance_monitoring: "enabled"
    error_tracking: "enabled"

# Artifact Integrity (SHA256 hashes)
artifact_hashes:
  model.pt: "a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"
  preprocessor.pkl: "b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef1234567a"

# Limitations and Risks
limitations:
  - "Trained only on CARLA simulator data"
  - "Performance may degrade in real-world conditions"
  - "Limited to specific weather and lighting conditions"
  - "Requires careful monitoring in production"

risks:
  safety:
    - "Model decisions should be validated by safety systems"
    - "Not suitable for safety-critical applications without additional safeguards"
  performance:
    - "May exhibit degraded performance on out-of-distribution inputs"
    - "Requires periodic retraining to maintain performance"
  ethical:
    - "Training data may contain biases"
    - "Decisions should be auditable and explainable"

# Maintenance
maintenance:
  retraining_schedule: "quarterly"
  monitoring_frequency: "daily"
  performance_review: "monthly"
  version_lifecycle: "12_months"

# Contact Information
maintainers:
  - name: "CarlaRL Team"
    email: "team@carlarl.ai"
    role: "primary"
  - name: "ML Engineering"
    email: "ml-eng@carlarl.ai"
    role: "infrastructure"

# License and Usage
license: "MIT"
usage_restrictions: "Research and development use only"
commercial_use: "Contact maintainers for licensing"

# Changelog
changelog:
  v0.1.0:
    date: "2025-09-27"
    changes:
      - "Initial model release"
      - "PPO training on CARLA simulator"
      - "Basic preprocessing pipeline"
      - "Production serving infrastructure"
